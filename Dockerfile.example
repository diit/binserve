# Example Dockerfile for deploying a static site with binserve
# Works with any static site generator (Astro, Hugo, Next.js, Gatsby, etc.)

# Stage 1: Build your static site
FROM node:20-alpine AS builder

WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm ci

# Copy source files and build
COPY . .
RUN npm run build

# Stage 2: Serve with binserve
FROM ghcr.io/diit/binserve:v0.2.0

# Copy built site from builder to /app/public/
# Adjust the source path based on your framework's output directory:
# - Astro: /app/dist
# - Hugo: /app/public
# - Next.js: /app/out
# - Gatsby: /app/public
# - Vite: /app/dist
COPY --from=builder /app/dist /app/public/

# Optional: Copy custom binserve config
# COPY binserve.json /app/binserve.json

# That's it! The image is ready to run.
# Port 3000 is exposed by default.
# Supports both amd64 and arm64 architectures.

